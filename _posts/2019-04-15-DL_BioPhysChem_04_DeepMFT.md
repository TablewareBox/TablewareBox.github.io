---
layout:     post
title:      æ·±åº¦å¹³å‡åœºä¸ç»Ÿè®¡ç¥ç»åŠ¨åŠ›å­¦
subtitle:   æ·±åº¦å­¦ä¹ çš„ç”Ÿç‰©ç‰©ç†åŒ–å­¦åŸç† ç¬¬4ç« 
date:       2019-04-15
author:     TablewareBox
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - DL & BioPhysChem
    - æ·±åº¦å­¦ä¹ ç†è®º
    - å¹³å‡åœºç†è®º
    - ç”Ÿç‰©ç‰©ç†åŒ–å­¦
    - ç»Ÿè®¡åŠ›å­¦
    - æ— åºç³»ç»Ÿ
---

## [æ·±åº¦å­¦ä¹ çš„ç”Ÿç‰©ç‰©ç†åŒ–å­¦åŸç† - Notes Project Overview](https://tablewarebox.github.io/2019/02/16/DL_BioPhysChem_content/)

![knowledge atlas](https://tablewarebox.files.wordpress.com/2018/11/concept-map-81.png)

## å¼•è¨€

**æ·±åº¦å¹³å‡åœºç†è®º**æ˜¯è¿‘å¹´æ¥ Google Brain ç ”ç©¶äººå‘˜æå‡ºçš„ï¼Œç”¨äºè§£é‡Šæ·±åº¦ç¥ç»ç½‘ç»œçš„**è¡¨è¾¾èƒ½åŠ›ã€è®­ç»ƒæŠ€å·§**å’Œ**æ¨¡å‹æ¶æ„**çš„ç†è®ºæ¡†æ¶ï¼Œå…¶æ ¹æºå¯è¿½æº¯åˆ°æ—¥æœ¬å­¦è€…**ç”˜åˆ©ä¿Šä¸€(Shun-ichi Amari)** ä¸Šä¸–çºª70å¹´ä»£æå‡ºçš„**ç»Ÿè®¡ç¥ç»åŠ¨åŠ›å­¦**[^1]ã€‚åœ¨80å¹´ä»£ **Hopfield ç½‘ç»œ**æå‡ºä¹‹åï¼ŒH. Sompolinsky, A. Crisanti å’Œ H. J. Sommers ç­‰äººå°†å…¶å‘å±•ä¸º**è‡ªæ—‹ç»ç’ƒæ¨¡å‹**æ‰€è¡ç”Ÿ**æ— å‘ç¥ç»ç½‘ç»œ**çš„**åŠ¨æ€å¹³å‡åœºç†è®º**[^2]ï¼Œç ”ç©¶ç½‘ç»œè¿è¡Œæ—¶ä¸€èˆ¬æ€§çš„åŠ¨åŠ›å­¦æ€§è´¨ï¼Œå¹¶æè¿°äº†**æœ‰åº-æ··æ²Œç›¸å˜**ã€‚ç”±äºæ— å‘ç¥ç»ç½‘ç»œçš„**æ—¶é—´æ¼”åŒ–ã€åŠ¨æ€é—®é¢˜**ç±»ä¼¼äºæœ‰å‘ç¥ç»ç½‘ç»œçš„**å±‚é—´ä¼ é€’ã€æ·±åº¦é—®é¢˜**ï¼ŒS. S. Schoenholz, S. Ganguli, J. Pennington å’Œ J. Sohl-Dickstein ç­‰äººé‡æ–°ä»¥ç°ä»£çš„**æœ‰å‘ï¼ˆå‰é¦ˆï¼‰ç¥ç»ç½‘ç»œ**ç»“æ„è¿›è¡Œäº†æ¨å¯¼ï¼Œä»–ä»¬çš„ä¸€ç³»åˆ—ç†è®ºå·¥ä½œå·²èƒ½ä¸€å®šç¨‹åº¦ä¸Šä¸ºç½‘ç»œç»“æ„å’Œè®­ç»ƒæŠ€å·§çš„è®¾è®¡æä¾›æŒ‡å¯¼ã€‚

ç¬”è®°çš„è¿™ä¸€ç« èŠ‚æ¶æ„å¦‚ä¸‹ï¼š

### Part I - ç†è®ºåŸºç¡€

- [x] åŠ¨æ€å¹³å‡åœºç†è®ºå›é¡¾[^2]
- [x] æ·±åº¦å¹³å‡åœºï¼šç†è®ºå‡è®¾ä¸é«˜æ–¯è¿‡ç¨‹è§†è§’[^3]
- [ ] æ·±åº¦ç½‘ç»œçš„æŒ‡æ•°çº§è¡¨è¾¾èƒ½åŠ›[^4]
- [ ] æ·±åº¦ä¿¡æ¯ä¼ æ’­ï¼šè®­ç»ƒä¸­çš„æœ‰åº-æ··æ²Œç›¸å˜[^5]

### Part II - è®­ç»ƒæŠ€å·§

- [ ] è®­ç»ƒæŠ€å·§ I: æ­£äº¤åˆå§‹åŒ– - åŠ¨æ€ç­‰è·ä¸æ™®é€‚ç±»[^6][^7]
- [ ] è®­ç»ƒæŠ€å·§ II: æ®‹å·®ç½‘ç»œçš„è¿è¡ŒåŸç†[^8]
- [ ] è®­ç»ƒæŠ€å·§ III: å±‚å®½åº¦å˜åŒ–ã€å±‚æ–¹å·®å˜åŒ–çš„è¿è¡ŒåŸç†[^9]
- [ ] è®­ç»ƒæŠ€å·§ IV: æ‰¹å½’ä¸€åŒ–çš„è¿è¡ŒåŸç†[^10]

### Part III - ç½‘ç»œç»“æ„

- [ ] CNN çš„å¹³å‡åœºç†è®º[^11]
- [ ] RNN, LSTM, GRU çš„å¹³å‡åœºç†è®º[^12][^13]
- [ ] å›¾ç½‘ç»œçš„å¹³å‡åœºç†è®º[^14]

## 4.1 åŠ¨æ€å¹³å‡åœºç†è®ºå›é¡¾

### 4.1.1 æ¨¡å‹å»ºç«‹

ç”˜åˆ©ä¿Šä¸€(Shun-ichi Amari) å»ºç«‹çš„æ¨¡å‹ä¸­ï¼Œ$N$ ä¸ª**ç¥ç»å…ƒ**ç”±è¿ç»­å˜é‡ $\{s_i(t)\in[-1,1]\},\,\,i=1,...,N$ æè¿°ï¼ˆå¯¹åº”è‡ªæ—‹ï¼‰ï¼Œâ€œ**çªè§¦çŸ©é˜µ**â€ $\mathbf{J}$ ï¼ˆå¯¹åº”è‡ªæ—‹çš„è€¦åˆå¸¸æ•°ï¼‰è¡¨è¾¾å®ƒä»¬çš„ç›¸äº’ä½œç”¨ã€‚æ¯ä¸€æ—¶åˆ» $t$ ç¥ç»å…ƒçš„çŠ¶æ€ $s_i(t)$ ç”±**åœº $h_i(t)$** å†³å®šï¼š

$$s_{i}(t)=\phi(g h_{i}(t))$$

å…¶ä¸­ $\phi(x)$ ä¸º**éçº¿æ€§æ¿€æ´»å‡½æ•°**ï¼Œå¯é€‰ä¸ºä»»æ„ Så‹å‡½æ•°ï¼Œå¦‚ $\phi(x)=\tanh (x)$ï¼Œéœ€æ»¡è¶³ $\phi(\pm\infty)=\pm 1, \phi(-x)=-\phi(x), \phi'(x)>0.$ 

$g$ ä¸º**éçº¿æ€§æŒ‡æ•°**ï¼Œå¯ä»¥ç±»æ¯” $\beta=1/k_\mathrm{B}T$ï¼š$g\sim 0, T\to\infty$ æ—¶ $\phi(x)\sim x$ï¼›$g\to \infty,T\to 0$ æ—¶ $\phi(x)\to \pm 1.$

æ—¶é—´æ¼”åŒ–çš„**åŠ¨åŠ›å­¦æ–¹ç¨‹**ä¸º

$$
\partial_{t} h_{i}=-h_{i}+\sum_{j=1}^{N} J_{i j} s_{j}+\theta_i=-h_{i}+\sum_{j=1}^{N} J_{i j} \phi(g h_{j})+\theta_i
$$

è‹¥å°†å…¶ç§»é¡¹ï¼Œå¯ä»¥çœ‹å‡ºå®ƒå’Œå‰é¦ˆç¥ç»ç½‘ç»œçš„å…³ç³»ï¼š

$$
\begin{cases}
    h_{i}+\partial_{t} h_{i}=\sum_{j=1}^{N} J_{i j} s_{j}+\theta_i \\
    s_i=\phi(g h_{i})
\end{cases}
\longleftrightarrow
\begin{cases}
    \mathbf{h}^{l+1}=\mathbf{W}^{l+1} \mathbf{x}^{l}+\mathbf{b}^{l+1} \\
    \mathbf{x}^{l}=\phi(\mathbf{h}^{l})
\end{cases}
$$

å®é™…ä¸Šè¿™ä¹Ÿæ˜¯**æ— å‘ç¥ç»ç½‘ç»œ**ä¸**æœ‰å‘ç¥ç»ç½‘ç»œ**çš„å·®åˆ«ï¼šæ— å‘ç¥ç»ç½‘ç»œçš„**æ—¶é—´æ¼”åŒ–ã€åŠ¨æ€é—®é¢˜**ç±»ä¼¼äºæœ‰å‘ç¥ç»ç½‘ç»œçš„**å±‚é—´ä¼ é€’ã€æ·±åº¦é—®é¢˜**ã€‚ä»è¿™ä¸€ç‚¹çœ‹è‡ªæ—‹ç»ç’ƒç±»**æ— å‘ç¥ç»ç½‘ç»œ**å¯ä»¥ç†è§£æˆ**æƒé‡ç›¸åŒçš„æ— é™å±‚æœ‰å‘ç¥ç»ç½‘ç»œ**ã€‚

### 4.1.2 æ–¹ç¨‹æ¨å¯¼

æ–¹ç¨‹ä¸­åŒ…å«çš„éšæœºæ€§æ¥æºäºéšæœºçš„è€¦åˆå¸¸æ•° $J_{ij}$ã€‚**åŠ¨æ€é—®é¢˜çš„ç»Ÿè®¡æ€§è´¨**ä¹Ÿå°±æ˜¯éšæœºçš„ $J_{ij}$ ä¸‹è¿è¡Œè·¯å¾„ $\mathbf{h}(t)$ çš„æ¦‚ç‡åˆ†å¸ƒã€‚ç„¶è€Œæ¦‚ç‡åˆ†å¸ƒå¾€å¾€æ— æ³•ç›´æ¥è®¡ç®—ï¼Œåªèƒ½é€šè¿‡è¿‘ä¼¼æ–¹æ³•è®¡ç®—å®ƒçš„**çŸ©(moment**)ã€‚**éšæœºå˜é‡**æ¦‚ç‡åˆ†å¸ƒçš„**çŸ©**å¯ä»¥é€šè¿‡**çŸ©ç”Ÿæˆå‡½æ•°(å¯¹åº”é…åˆ†å‡½æ•°**)å¯¹**å…±è½­å˜é‡**ä¸æ–­æ±‚å¯¼å¾—åˆ°ï¼Œç±»ä¼¼åœ°ï¼Œ**éšæœºè¿‡ç¨‹**æ¦‚ç‡åˆ†å¸ƒçš„**çŸ©**å¯ä»¥é€šè¿‡**ç”Ÿæˆæ³›å‡½**å¯¹**å…±è½­å˜é‡**ä¸æ–­æ±‚å¯¼å¾—åˆ°ã€‚å…³äº**ç”Ÿæˆæ³›å‡½ï¼ˆè·¯å¾„ç§¯åˆ†ï¼‰æ–¹æ³•**çš„ç®€ä»‹å¯ä»¥å‚è€ƒ[^15]ã€‚

ç”Ÿæˆæ³›å‡½éœ€è¦å¯¹ $J_{ij}$ åŠæ‰€æœ‰å¯èƒ½çš„**è·¯å¾„** $\mathbf{h}(t)$ åš**æ³›å‡½ç§¯åˆ†**ï¼Œä¹Ÿå°±æ˜¯è¯´ $D \mathbf{h}=D[\mathbf{h}(t)].$ å¼•å…¥ $\hat{\mathbf{h}}(t)$ ä»¥æ»¡è¶³æ—¶é—´æ¼”åŒ–æ–¹ç¨‹ï¼Œå¼•å…¥å…±è½­åœº $\mathbf{l}(t)$ å’Œ $\hat{\mathbf{l}}(t)$ï¼Œå®šä¹‰**ç”Ÿæˆæ³›å‡½**ï¼š

$$
\begin{aligned}
    Z_{\mathbf{J}}[\mathbf{l}(t),\mathbf{\hat{l}}(t)] &
    =\int D \mathbf{h} D \mathbf{\hat{h}} \,\,p(\mathbf{h, \hat{h}})\exp \left\{\sum_{i, t}\left(l_{i}(t) h_{i}(t)+i \hat{l}_{i}(t) i \hat{h}_{i}(t)\right)\right\} \\
    & =\int D \mathbf{h} D \mathbf{\hat{h}} \exp \left\{\sum_{i, t}\left(l_{i}(t) h_{i}(t)+i \hat{l}_{i}(t) i \hat{h}_{i}(t)\right)+L[\mathbf{h, \hat{h}}]\right\} \\
\end{aligned}

$$

$$
L[h, \hat{h}]=\sum_{i, t}-i \hat{h}_{i}(t)\left[(1+\partial_{t}) h_{i}(t)-\sum_{j} J_{i j} s_{j}(t)\right], \,\,Z_{\mathbf{J}}[\mathbf{0},\mathbf{0}]=1
$$

å®ƒçš„ä½œç”¨ç›¸å½“äºå¹³è¡¡æ€ç»Ÿè®¡ç‰©ç†ä¸­çš„**é…åˆ†å‡½æ•°**ï¼ŒåŒ…å«äº†ç³»ç»Ÿæ¼”åŒ–çš„æ‰€æœ‰ä¿¡æ¯ã€‚åŠ¨æ€é—®é¢˜ä¸­æœ€é‡è¦çš„çŸ©æ˜¯**æ—¶é—´å…³è”å‡½æ•°**å’Œ**å“åº”å‡½æ•°**ï¼š

$$ 
C(t, t^{\prime})=\left.\frac{\partial Z}{\partial \mathbf{\hat{l}}(t^{\prime}) \partial \mathbf{\hat{l}}(t)}\right|_{\mathbf{l}(t)=\mathbf{\hat{l}}(t)=0},\,\,\,
R(t, t^{\prime})=\left.\frac{\partial Z}{\partial \mathbf{\hat{l}}(t^{\prime})\partial \mathbf{l}(t)}\right|_{\mathbf{l}(t)=\mathbf{\hat{l}}(t)=0}
$$

### 4.1.3 æœ‰åºâ€”æ··æ²Œç›¸å˜

## 4.2 æ·±åº¦å¹³å‡åœºï¼šç†è®ºå‡è®¾ä¸é«˜æ–¯è¿‡ç¨‹è§†è§’

å›åˆ°å¯¹**å‰é¦ˆç¥ç»ç½‘ç»œ**çš„è®¨è®ºã€‚

* ç½‘ç»œå…±æœ‰ $D+1$ å±‚**ç¥ç»å…ƒ** $\mathbf{x}^0,...,\mathbf{x}^D$ï¼Œç¬¬ $l$ å±‚çš„**å®½åº¦**ä¸º $N_l$ï¼Œ
* $D$ å±‚**æƒé‡** $\mathbf{W}^1,...,\mathbf{W}^D$ å’Œ**åç½®** $\mathbf{b}^1,...,\mathbf{b}^D$ã€‚$\mathbf{x}^l, \mathbf{b}^l \in\mathbb{R}^{N_l},\mathbf{W}^l \in\mathbb{R}^{N_l\times N_{l-1}}.$
* å¯¹äº**éšæœºåˆå§‹åŒ–**çš„ç¥ç»ç½‘ç»œï¼Œ$\mathbf{W} _ {ij}^l,\mathbf{b} _ {i}^l$ ä¸ºç‹¬ç«‹çš„é›¶å‡å€¼é«˜æ–¯éšæœºå˜é‡ï¼Œæ–¹å·®è®¾å®šä½¿å¾— $l-1$ å±‚ç¥ç»å…ƒå¯¹ $l$ å±‚ç¥ç»å…ƒåœºçš„è´¡çŒ®ä¸º $\mathcal{O}(1)$ï¼š

$$\mathbf{W}_{ij}^l \sim \mathcal{N}(0,\sigma_{w}^{2} / N_{l-1}),\,\,\,\,\,\mathbf{b}_{i}^l \sim \mathcal{N}(0,\sigma_{b}^{2})
$$

* å‰å‘ä¼ æ’­çš„åŠ¨åŠ›å­¦ä¸º

$$ 
\mathbf{h}^{l}=\mathbf{W}^{l} \mathbf{x}^{l-1}+\mathbf{b}^{l},\,\,\,\,\,
\mathbf{x}^{l}=\phi(\mathbf{h}^{l})
 $$

## å‚è€ƒæ–‡çŒ®

[^1]: S. I. Amari. **Characteristics of Random Nets of Analog Neuron-Like Elements.** *IEEE Trans. Syst. Man Cybern.* **2**, 643 (1972).

[^2]: H. Sompolinsky, A. Crisanti, and H. J. Sommers. **Chaos in random neural networks.** *Physical Review Letters*, 61(3): 259, 1988.

[^3]: Jaehoon Lee, Yasaman Bahri, Roman Novak, Samuel S. Schoenholz, Jeffrey Pennington, and Jascha Sohl-Dickstein. **Deep neural networks as Gaussian processes.** *International Conference on Learning Representations*, 2018.

[^4]: Ben Poole, Subhaneil Lahiri, Maithreyi Raghu, Jascha Sohl-Dickstein, and Surya Ganguli. **Exponential expressivity in deep neural networks through transient chaos.** In *Advances In Neural Information Processing Systems*, pages 3360â€“3368, 2016.

[^5]: Samuel S. Schoenholz, Justin Gilmer, Surya Ganguli, and Jascha Sohl-Dickstein. **Deep Information Propagation.** *International Conference on Learning Representations*, 2017.

[^6]: Jeffrey Pennington, Samuel S. Schoenholz, and Surya Ganguli. **Resurrecting the sigmoid in deep learning through dynamical isometry: theory and practice.** *Advances in Neural Information Processing Systems*, 2017.

[^7]: Jeffrey Pennington, Samuel S. Schoenholz, and Surya Ganguli. **The emergence of spectral universality in deep networks.** *International Conference on Artificial Intelligence and Statistics (AISTATS)*, 2018.

[^8]: Greg Yang, and Samuel S. Schoenholz. **Mean field residual networks: On the edge of chaos.** In *Advances in Neural Information Processing Systems*, 2017.

[^9]: Greg Yang and Samuel S. Schoenholz. **Deep mean field theory: Layerwise variance and width variation as methods to control gradient explosion.** *International Conference on Learning Representations*, 2018.

[^10]: Greg Yang, Jeffrey Pennington, Vinay Rao, Jascha Sohl-Dickstein, and Samuel S. Schoenholz. **A mean field theory of batch normalization.** *International Conference on Learning Representations*, 2019.

[^11]: Lechao Xiao, Yasaman Bahri, Jascha Sohl-Dickstein, Samuel S. Schoenholz, and Jeffrey Pennington. **Dynamical isometry and a mean field theory of CNNs: How to train 10,000-layer vanilla convolutional neural networks.** *International Conference on Learning Representations*, 2018.

[^12]: Minmin Chen, Jeffrey Pennington, and Samuel S. Schoenholz. **Dynamical isometry and a mean field theory of RNNs: Gating enables signal propagation in recurrent neural networks.** *International Conference on Learning Representations*, 2018.

[^13]: Dar Gilboa, Bo Chang, Minmin Chen, Greg Yang, Samuel S. Schoenholz, Ed H. Chi, and Jeffrey Pennington. **Dynamical isometry and a mean field theory of LSTMs and GRUs.** *arXiv preprint arXiv:1901.08987*, 2019.

[^14]: Tatsuro Kawamoto, and Masashi Tsubaki. **Mean-field theory of graph neural networks in graph partitioning.** *arXiv preprint arXiv:1810.11908*, 2018.

[^15]: Chow C, Buice M (2015) **Path integral methods for stochastic differential equations.** *The Journal of Mathematical Neuroscience* 5(1):8, DOI: 10.1186/s13408-015-0018-5