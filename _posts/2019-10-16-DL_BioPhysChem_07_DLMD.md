---
layout:     post
title:      ?????????????
subtitle:   ????????????? ?7?
date:       2019-10-16
author:     TablewareBox
header-img: img/Molecular-Dynamics-DL.jpg
catalog: true
tags:
    - ?????
    - ????
    - ????
    - ?????
    - ????
---

## [????????????? - Notes Project Overview](https://tablewarebox.github.io/2019/02/16/DL_BioPhysChem_content/)

![knowledge atlas](https://tablewarebox.files.wordpress.com/2018/11/concept-map-81.png)

## ??

**????**???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????

????????????????????????????????????????**????**?????????????????????????**?????**?????2013????????QM/MM??**???**???**????**???????????????????????????????????????????????????????????????????

????????????

### Part I - ?????????Illustrated Molecular Dynamics?

- [x] ?? - scheme 1
- [x] ???(??)????? - scheme 2,3
- [ ] ?????? - scheme 4
- [ ] ???????? - scheme 5
- [ ] ??????&????? - scheme 6
- [ ] ??????&?????? - scheme 7
- [ ] ??? - scheme 8
- [ ] ???? - scheme 9

### Part II - ?????????????

### Part III - ?????????????????

### Part IV - ???????????????

## 7.1 ????????

### 7.1.1 ????

????(Shun-ichi Amari) ???????$N$ ?**???**????? $\{s_i(t)\in[-1,1]\},\,\,i=1,...,N$ ??????????**????**? $\mathbf{W}$??????????????????????? $-\mathbf{b}$ ??????$W _ {ij}\sim\mathcal{N}(w_0/N,\sigma _ w^2/N),b _ i\sim\mathcal{N}(b_0,\sigma _ b^2)$ ?????????????????? $t$ ?????? $x_i(t)$ ?**??? $h_i(t)$** ???

$$x_{i}(t)=\phi(h_{i}(t))$$

?? $\phi(h)$ ?**???????**?????? S????? $\phi(h)=\tanh (gh)$???? $\phi(\pm\infty)=\pm 1, \phi(-h)=-\phi(h), \phi'(h)>0.$ 

$g$ ?**?????**????? $\beta=1/k_\mathrm{B}T$?$g\to 0, T\to\infty$ ? $\phi(h)\sim gh$?$g\to \infty,T\to 0$ ? $\phi(h)\to \pm 1.$

?????**?????**?

$$
\partial_{t} h_{i}=-h_{i}+\sum_{j=1}^{N} W_{i j} x_{j}+b_i=-h_{i}+\sum_{j=1}^{N} W_{i j} \phi(h_{j})+b_i
$$

??????????????????????

$$
\begin{cases}
    h_{i}+\partial_{t} h_{i}=\sum_{j=1}^{N} W_{i j} x_{j}+b_i \\
    x_i=\phi(h_{i})
\end{cases}
\longleftrightarrow
\begin{cases}
    \mathbf{h}^{l+1}=\mathbf{W}^{l+1} \mathbf{x}^{l}+\mathbf{b}^{l+1} \\
    \mathbf{x}^{l}=\phi(\mathbf{h}^{l})
\end{cases}
$$

??????**??????**?**??????**???????????**?????????**??????????**?????????**???????????**??????**?????**??????????????**?

????????**???**?????????????????????????????**?????**???**?????**?

> ????????????????????????? $J _ {ij}=J _ {ji}$ ????????????????????????????**??????**??????????????????????????????????????????????**???????**?

**???????**????????????????**???**?????**??????**[^15]??????**???(overlap)??**?

$$
q_{aa}=\frac{1}{N} \sum_{i=1}^{N}\sigma_{i,a}^{2},\quad q_{ab}=\frac{1}{N} \sum_{i=1}^{N}\sigma_{i,a}\sigma_{i,b}
$$

$$
q_{\alpha \alpha}=\frac{1}{N} \sum_{i=1}^{N}\langle\sigma_{i}\rangle_{\alpha}^{2},\quad q_{\alpha \beta}=\frac{1}{N} \sum_{i=1}^{N}\langle\sigma_{i}\rangle_{\alpha}\langle\sigma_{i}\rangle_{\beta}
$$

**????(self-overlap)** $q _ {aa}, q _ {\alpha \alpha}$ ??**????? $a$** ?**? $\alpha$** ?**??**???? $q _ {ab}, q _ {\alpha \beta}$ ??**????? $a,b$** ?**? $\alpha,\beta$** ??**???**?????????**????(replica method)** ???????????????????????????????????????????**????(replica symmetric, RS)????**???? $q _ {ab}$ ????????? $q _ {aa}$??**????????(1RSB)????**???? $q _ {ab}$ ????? $q _ 0,q _ 1$??????????**??**????

$$ 
q_{a b}=\left[
    \begin{array}{ccccccc}
    1     & q_{1} & q_{1} &       &       &       & \\
    q_{1} & 1     & q_{1} &       & q_{0} &       & \cdots \\
    q_{1} & q_{1} & 1     &       &       &       & \\
          &       &       & 1     & q_{1} & q_{1} & \\
          & q_{0} &       & q_{1} & 1     & q_{1} & \\
          &       &       & q_{1} & q_{1} & 1     & \\
          &\vdots &       &       &       &       & \ddots
    \end{array}
\right]
$$

<div align="center">?1  1RSB ???????<b>?????</b>?????????</div>

??????????????????????**??(replicas)** ?????????

$$ 
q_{aa}^{l}=\frac{1}{N_{l}} \sum_{i=1}^{N_{l}}[\mathbf{h}_{i}^{l}(\mathbf{x}^{0, a})]^{2},\,\,\,\,\,q_{a b}^{l}=\frac{1}{N_{l}} \sum_{i=1}^{N_{l}} \mathbf{h}_{i}^{l}(\mathbf{x}^{0, a}) \mathbf{h}_{i}^{l}(\mathbf{x}^{0, b}) \quad a, b \in\{1,2\}
$$

???? 4.2 ???**???????**??????

### 4.1.2 Amari ?

Amari ???????**?????**??????????????????

* **??1(?????)**?$N$ ?????????????????????**??????**??? $h _ {i}(t)$ ????????????$h _ {i}(t)\sim\mathcal{N}(m(t),q(t))$?

???? $h _ i(t)$ ??? $f(h)$ ?????????? $h _ i(t)$ ??????????

$$
\begin{aligned}
    F & =\int_{-\infty}^{\infty} \frac{1}{\sqrt{2 \pi q(t)}} f(h) \exp \left\{-\frac{(h-m(t))^{2}}{2 q(t)}\right\} \mathrm{d} h \\
    &=\int \mathcal{D}z \cdot f\left[\sqrt{q(t)}z+m(t)\right],\quad \mathcal{D}z =\frac{\mathrm{d} z}{\sqrt{2 \pi}} e^{-z^{2}/2}
\end{aligned}

$$

??????? $t$ ?????

$$
h_{i}(t)=\int_{0}^{t}\left\{\sum_j w_{i j} x_{j}(\tau)+b_{i}\right\} e^{\tau-t} \mathrm{d} \tau+h_{i}(0) e^{-t}
$$


??????**???????**??????????????????????????????? $w _ 0=b _ 0=0$?????????

$$
q^*=\sigma_w^2 \int \mathcal{D}z \cdot \phi^2(\sqrt{q^*}z)+\sigma_b^2
$$

???????

$$
\left.\frac{\partial \mathcal{V}(q|\sigma_w^2,\sigma_b^2)}{\partial q}\right|_{q=q^*} <1
$$

????????????????**??????**([4.2.1](#421-???????????-mathcalvq_aa))?????????**???(???)?????**([4.2.2](#422-???????????-mathcalcc-_-12q-_-11q-_-12))??? $w _ 0,b _ 0\neq 0$ ??Amari ???????????????????????????????????

### 4.1.3 ?????????

> ??????Amari ??????????????**???????**????????????????????????? [4.2](#42-????????????????)?**???????**???????????????????**????????????????**?????

??????????????????? $J_{ij}$?**?????????**?????? $J_{ij}$ ????? $\mathbf{h}(t)$ ?????????????????????????????????**?(moment**)???**????????????**???????[^16]?

* **????**?????**?**????**?????(??????**)?**????**???????
* ????**????**?????**?**????**????**?**????**???????

$$
L[h, \hat{h}]=\sum_{i, t}-i \hat{h}_{i}(t)\left[(1+\partial_{t}) h_{i}(t)-\sum_{j} J_{i j} s_{j}(t)\right], \,\,Z_{\mathbf{J}}[\mathbf{0},\mathbf{0}]=1
$$

????????????????**????**?????????????????????????**??????**?**????**?

$$ 
C(t, t^{\prime})=\left.\frac{\partial Z}{\partial \mathbf{\hat{l}}(t^{\prime}) \partial \mathbf{\hat{l}}(t)}\right|_{\mathbf{l}(t)=\mathbf{\hat{l}}(t)=0},\,\,\,
R(t, t^{\prime})=\left.\frac{\partial Z}{\partial \mathbf{\hat{l}}(t^{\prime})\partial \mathbf{l}(t)}\right|_{\mathbf{l}(t)=\mathbf{\hat{l}}(t)=0}
$$

### 4.1.4 ???????

## 4.2 ?????????????????

???**??????**????

* ???? $D+1$ ?**???** $\mathbf{x}^0,...,\mathbf{x}^D$?? $l$ ??**??**? $N_l$?
* $D$ ?**??** $\mathbf{W}^1,...,\mathbf{W}^D$ ?**??** $\mathbf{b}^1,...,\mathbf{b}^D$?$\mathbf{x}^l, \mathbf{b}^l \in\mathbb{R}^{N_l},\mathbf{W}^l \in\mathbb{R}^{N_l\times N_{l-1}}.$
* ??**?????**??????$\mathbf{W} _ {ij}^l,\mathbf{b} _ {i}^l$ ???????????????????? $l-1$ ????? $l$ ????????? $\mathcal{O}(1)$??????????

$$\mathbf{W}_{ij}^l \sim \mathcal{N}(0,\sigma_{w}^{2} / N_{l-1}),\quad\mathbf{b}_{i}^l \sim \mathcal{N}(0,\sigma_{b}^{2})
$$

* ?????????

$$
\mathbf{h}^{l}=\mathbf{W}^{l} \mathbf{x}^{l-1}+\mathbf{b}^{l},\quad
\mathbf{x}^{l}=\phi(\mathbf{h}^{l})
$$

**???????**??????????**???**????????????????????????????**??(replicas)** ?????????**???**??

$$ 
q_{aa}^{l}=\frac{1}{N_{l}} \sum_{i=1}^{N_{l}}(\mathbf{h}_{i}^{l})^{2},\quad q_{a b}^{l}=\frac{1}{N_{l}} \sum_{i=1}^{N_{l}} \mathbf{h}_{i}^{l}(\mathbf{x}^{0, a}) \mathbf{h}_{i}^{l}(\mathbf{x}^{0, b}) \quad a, b \in\{1,2\}
$$

### 4.2.1 ??????????? $\mathcal{V}(q_{aa})$

**?????**???$N _ {l-1}$ ????$\mathbf{h} _ {i}^{l}=\sum _ {j} \mathbf{W} _ {i j}^{l} \phi(\mathbf{h} _ {j}^{l-1})+\mathbf{b} _ {i}^{l}$ ?????????????**??????**???**????**?????????? $z$ ?????? $N_{l-1}$ ????????????????????

$$
\begin{aligned}
    q^{l}=\langle(\mathbf{h}_{i}^{l})^{2}\rangle &=\left\langle[\mathbf{W}_{ij}^{l} \cdot \phi(\mathbf{h}_{j}^{l-1})]^{2}\right\rangle+\langle(\mathbf{b}_{i}^{l})^{2}\rangle \\
    &=\sigma_{w}^{2} \frac{1}{N_{l-1}} \sum_{j=1}^{N_{l-1}} \phi(\mathbf{h}_{j}^{l-1})^{2}+\sigma_{b}^{2} \\
    &=\mathcal{V}(q^{l-1} | \sigma_{w}, \sigma_{b}) \\
    &\equiv \sigma_{w}^{2} \int \mathcal{D} z\,\, \phi\left(\sqrt{q^{l-1}} z\right)^{2}+\sigma_{b}^{2}
\end{aligned}
$$

$$ 
\mathcal{D} z=\frac{\mathrm{d} z}{\sqrt{2 \pi}} e^{-z^{2}/2},\quad
q^{0}=\frac{1}{N_{0}} \mathbf{x}^{0} \cdot \mathbf{x}^{0},\quad
q^{1}=\sigma_{w}^{2} q^{0}+\sigma_{b}^{2}
$$

?? $\mathcal{V}(q)$ ???????????????????? $\phi$ ?**????????**?$q^{l}=\mathcal{V}(q^{l-1}\vert\sigma _ w,\sigma _ b)$ ???? $q^{l}=q^{l-1}$ ?????? $q^*(\sigma _ w,\sigma _ b).$ ???????????

* $\sigma _ b =0, \sigma _ w <1$ ???????? $q^*=0$?????? $q$ ???0.
* $\sigma _ b =0, \sigma _ w >1$ ??$q^*=0$ ?????????????????? $q^ * >0.$
* $\sigma _ b >0$ ????????? $q^ * >0.$

![deepmft_1-1](https://tablewarebox.files.wordpress.com/2019/10/molecular-dynamics-dl.jpg)
<div align="center">?1  $\phi(h)=\tanh(h)$??? $N_l=1000$ ???? $q^l$ ?????</div>

<div align="center">(A)(B) $\sigma_b=0.3,\sigma_w=1.3,2.5,4.0$ ???????? $\mathcal{V}$ ??????????????????</div>

<div align="center">(C)??? $q^*$ ?? $\sigma _ w, \sigma _ b$ ??? (D)????????1%?????????????(A)(B)?????????</div>

### 4.2.2 ??????????? $\mathcal{C}(c _ {12},q _ {11},q _ {12})$

?????? $\mathbf{x}^{0,1}, \mathbf{x}^{0,2}$ ??$2\times2$ ?????

$$ 
q_{a b}^{l}=\frac{1}{N_{l}} \sum_{i=1}^{N_{l}} \mathbf{h}_{i}^{l}(\mathbf{x}^{0, a}) \mathbf{h}_{i}^{l}(\mathbf{x}^{0, b}) \quad a, b \in\{1,2\}
$$

????????**?????**??$N _ {l-1}$ ????$\mathbf{h} _ {i}^{l}(\mathbf{x}^{0, a})$ ? $\mathbf{h} _ {i}^{l}(\mathbf{x}^{0, b})$ ??????????????????**??????**??????? $q _ {ab}^l$ ?**??????**????????????????

$$
\begin{aligned}
    q_{12}^{l}&=\mathcal{C}(c_{12}^{l-1}, q_{11}^{l-1}, q_{22}^{l-1} | \sigma_{w}, \sigma_{b}) \\
    &\equiv \sigma_{w}^{2} \int \mathcal{D} z_{1} \mathcal{D} z_{2} \phi(u_{1}) \phi(u_{2})+\sigma_{b}^{2}
\end{aligned}
$$

$$ 
u_{1}=\sqrt{q_{11}^{l-1}} z_{1}, \quad u_{2}=\sqrt{q_{22}^{l-1}}\left[c_{12}^{l-1} z_{1}+\sqrt{1-(c_{12}^{l-1})^{2}} z_{2}\right]
$$

$$ 
\langle u_{a} u_{b}\rangle= q_{a b}^{l-1},\quad c_{12}^{l}=\frac{q_{12}^{l}}{\sqrt{q_{11}^{l}q_{22}^{l}}}
$$

??????????????????**????** $c _ {12}^l$ ???$c _ {12}^l$ ???????????**???** $c^ * (\sigma _ w,\sigma _ b).$ ?? $q _ {11}, q _ {22}$ ???????? $q^ * (\sigma _ w,\sigma _ b)$????????????????? $q^ *$ ?? $q _ {11}, q _ {22}$?

$$
c_{12}^{l}=\frac{1}{q^{*}} \mathcal{C}(c_{12}^{l-1}, q^{*}, q^{*} | \sigma_{w}, \sigma_{b})
$$

??????????? $c^ * (\sigma _ w,\sigma _ b)=1.$ ?????????????? $\mathcal{C}$ ? $c^ *$ ??? $\chi _ 1$?

$$
\begin{aligned}
    \chi_{1} & \equiv\left.\frac{\partial c_{12}^{l}}{\partial c_{12}^{l-1}}\right|_{c=1} \\
    &=\left.\sigma_{w}^{2} \int \mathcal{D} z_{1} \mathcal{D} z_{2} \phi^{\prime}(u_{1}) \phi^{\prime}(u_{2})\right|_{c=1}\\
    & =\sigma_{w}^{2} \int \mathcal{D} z\left[\phi^{\prime}(\sqrt{q^{*} z})\right]^{2}
\end{aligned}
$$

???????????????????

$$
\int \mathcal{D} z F(z) z=\int \mathcal{D} z F^{\prime}(z)
$$

* $\chi _ 1<1$???? $\mathcal{C}$ ???????$c^ * =1$ ???????????????????**?????**?
* $\chi _ 1>1$???? $\mathcal{C}$ ? $c=1$ ?????????$c^ * =1$ ????????????????????**????**?

?? $\chi _ 1$ ???????????????????????????? $\mathbf{h}^l$ ? $\mathbf{h}^{l-1}$ ?**?????** $\mathbf{J} _ {i j}^{l}=\partial \mathbf{h} _ i^l / \partial \mathbf{h} _ j^{l-1}=\mathbf{W} _ {i j}^{l} \phi^{\prime}(\mathbf{h} _ {j}^{l-1})$?????????????? $\mathbf{h}^{l-1}+\mathbf{u}$ ??? $\mathbf{h}^{l}+\mathbf{J} \mathbf{u}$. ??????? $\lVert\mathbf{J u}\rVert _ {2}^{2} / \lVert\mathbf{u}\rVert _ {2}^{2}$ ??? $\mathbf{u}$????? $\mathbf{W}$??? $i=1,...,N_l$ ??????? $\mathbf{h} _ i^l$ ????? $\chi _ 1$???**?????**??????????????**????**???

![deepmft_2](https://tablewarebox.files.wordpress.com/2019/04/deepmft_2.png)
<div align="center">?2  $\phi(h)=\tanh(h)$??? $N _ l=1000$ ???? $q _ {ab}^l$ ?????</div>

<div align="center">(A)(B) $\sigma_b=0.3,\sigma_w=1.3,2.5,4.0$ ???????? $\mathcal{C}$ ??????????????????</div>

<div align="center">(C)??? $c^*$ ?? $\sigma _ w, \sigma _ b$ ??? (D)????? $\chi _ 1$ ?? $\sigma _ w, \sigma _ b$ ??????????(A)(B)?????????</div>

### 4.2.3 ???????

## ????

[^1]: S. I. Amari. **Characteristics of Random Nets of Analog Neuron-Like Elements.** *IEEE Trans. Syst. Man Cybern.* **2**, 643 (1972).

[^2]: H. Sompolinsky, A. Crisanti, and H. J. Sommers. **Chaos in random neural networks.** *Physical Review Letters*, 61(3): 259, 1988.

[^3]: Jaehoon Lee, Yasaman Bahri, Roman Novak, Samuel S. Schoenholz, Jeffrey Pennington, and Jascha Sohl-Dickstein. **Deep neural networks as Gaussian processes.** *International Conference on Learning Representations*, 2018.

[^4]: Ben Poole, Subhaneil Lahiri, Maithreyi Raghu, Jascha Sohl-Dickstein, and Surya Ganguli. **Exponential expressivity in deep neural networks through transient chaos.** In *Advances In Neural Information Processing Systems*, pages 3360?3368, 2016.

[^5]: Samuel S. Schoenholz, Justin Gilmer, Surya Ganguli, and Jascha Sohl-Dickstein. **Deep Information Propagation.** *International Conference on Learning Representations*, 2017.

[^6]: Jeffrey Pennington, Samuel S. Schoenholz, and Surya Ganguli. **Resurrecting the sigmoid in deep learning through dynamical isometry: theory and practice.** *Advances in Neural Information Processing Systems*, 2017.

[^7]: Jeffrey Pennington, Samuel S. Schoenholz, and Surya Ganguli. **The emergence of spectral universality in deep networks.** *International Conference on Artificial Intelligence and Statistics (AISTATS)*, 2018.

[^8]: Greg Yang, and Samuel S. Schoenholz. **Mean field residual networks: On the edge of chaos.** In *Advances in Neural Information Processing Systems*, 2017.

[^9]: Greg Yang and Samuel S. Schoenholz. **Deep mean field theory: Layerwise variance and width variation as methods to control gradient explosion.** *International Conference on Learning Representations*, 2018.

[^10]: Greg Yang, Jeffrey Pennington, Vinay Rao, Jascha Sohl-Dickstein, and Samuel S. Schoenholz. **A mean field theory of batch normalization.** *International Conference on Learning Representations*, 2019.

[^11]: Lechao Xiao, Yasaman Bahri, Jascha Sohl-Dickstein, Samuel S. Schoenholz, and Jeffrey Pennington. **Dynamical isometry and a mean field theory of CNNs: How to train 10,000-layer vanilla convolutional neural networks.** *International Conference on Learning Representations*, 2018.

[^12]: Minmin Chen, Jeffrey Pennington, and Samuel S. Schoenholz. **Dynamical isometry and a mean field theory of RNNs: Gating enables signal propagation in recurrent neural networks.** *International Conference on Learning Representations*, 2018.

[^13]: Dar Gilboa, Bo Chang, Minmin Chen, Greg Yang, Samuel S. Schoenholz, Ed H. Chi, and Jeffrey Pennington. **Dynamical isometry and a mean field theory of LSTMs and GRUs.** *arXiv preprint arXiv:1901.08987*, 2019.

[^14]: Tatsuro Kawamoto, and Masashi Tsubaki. **Mean-field theory of graph neural networks in graph partitioning.** *arXiv preprint arXiv:1810.11908*, 2018.

[^15]: Tommaso Castellani, and Andrea Cavagna. **Spin-glass theory for pedestrians.** *J. Stat. Phys.* (2005) P05012. DOI: 10.1088/1742-5468/2005/05/P05012.

[^16]: Chow C, Buice M (2015) **Path integral methods for stochastic differential equations.** *The Journal of Mathematical Neuroscience* 5(1):8, DOI: 10.1186/s13408-015-0018-5.